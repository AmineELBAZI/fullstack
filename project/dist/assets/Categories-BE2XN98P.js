import{c as M,u as S,r as m,j as e}from"./index-yrzGcrsz.js";import{c as l}from"./CategorieApi-NIYRnbMd.js";import{P as k,M as E}from"./Modal-CRmXHlMq.js";import{B as o}from"./Button-CeNaAo-j.js";import{V as t}from"./index-CyOt5fqF.js";import{u as P}from"./useQuery-CZB9O9Qr.js";import{u as p}from"./useMutation-DpsCt41A.js";import{T as q}from"./trash-2-DLPNPXD6.js";import"./axiosInstance-Cz6MWCIH.js";import"./LoadingSpinner-xF3CygPc.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=M("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),K=({onSelectCategorie:j})=>{const d=S(),{data:b=[],isLoading:N,error:y}=P({queryKey:["categories"],queryFn:()=>l.getAll().then(r=>r.data)}),h=p({mutationFn:l.create,onSuccess:()=>{d.invalidateQueries(["categories"]),t.success("Catégorie créée"),n()},onError:()=>t.error("Erreur création catégorie")}),x=p({mutationFn:({id:r,...s})=>l.update(r,s),onSuccess:()=>{d.invalidateQueries(["categories"]),t.success("Catégorie mise à jour"),n()},onError:()=>t.error("Erreur mise à jour catégorie")}),C=p({mutationFn:l.delete,onSuccess:()=>{d.invalidateQueries(["categories"]),t.success("Catégorie supprimée")},onError:()=>t.error("Erreur lors de la suppression de la catégorie : Pour supprimer une catégorie, celle-ci ne doit être liée à aucun produit.")}),[v,g]=m.useState(!1),[i,c]=m.useState(null),[u,a]=m.useState({nom:""}),f=(r=null)=>{r?(c(r),a({nom:r.nom})):(c(null),a({nom:""})),g(!0)},n=()=>{g(!1),c(null),a({nom:""})},w=r=>{r.preventDefault(),i?x.mutate({id:i.id,...u}):h.mutate(u)};return N?e.jsx("p",{children:"Chargement..."}):y?e.jsx("p",{children:"Erreur chargement catégories"}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold ",children:"Catégories"}),e.jsxs(o,{onClick:()=>f(),children:[e.jsx(k,{className:"h-4 w-4 mr-2"})," Nouvelle catégorie"]})]}),e.jsx("div",{className:"bg-gradient-to-br from-white to-gray-100 rounded-xl shadow-xl p-6 border border-gray-200",children:e.jsxs("table",{className:"w-full table-auto rounded overflow-hidden",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-700 bg-gradient-to-r from-indigo-100 to-purple-100",children:[e.jsx("th",{className:"p-3",children:"Nom"}),e.jsx("th",{className:"p-3",children:"Nombre de Produits"}),e.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:b.map(r=>e.jsxs("tr",{className:"hover:bg-indigo-50 transition cursor-pointer border-b",onClick:()=>j(r.id),children:[e.jsx("td",{className:"p-3 text-gray-800 font-medium",children:r.nom}),e.jsx("td",{className:"p-3 text-gray-600",children:r.produits?r.produits.length:0}),e.jsx("td",{className:"p-3 text-right",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"inline-flex space-x-2",children:[e.jsxs(o,{onClick:s=>{s.stopPropagation(),f(r)},className:"bg-blue-500 hover:bg-blue-600 text-white border border-blue-700 hover:border-blue-900 transition-all duration-200",children:[e.jsx(F,{className:"h-4 w-4 mr-2"})," Modifier"]}),e.jsxs(o,{onClick:s=>{s.stopPropagation(),window.confirm(`Supprimer la catégorie "${r.nom}" ?`)&&C.mutate(r.id)},className:"bg-red-500 hover:bg-red-600 text-white border border-red-700 hover:border-red-900 transition-all duration-200",children:[e.jsx(q,{className:"h-4 w-4 mr-2"})," Supprimer"]})]})})]},r.id))})]})}),e.jsx(E,{isOpen:v,onClose:n,title:i?"Modifier Catégorie":"Nouvelle Catégorie",children:e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 font-medium text-gray-700",children:"Nom"}),e.jsx("input",{type:"text",required:!0,value:u.nom,onChange:r=>a({nom:r.target.value}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"outline",onClick:n,children:"Annuler"}),e.jsx(o,{type:"submit",loading:h.isLoading||x.isLoading,children:i?"Modifier":"Créer"})]})]})})]})};export{K as default};
